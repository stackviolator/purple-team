attack_technique: T1003.001
display_name: "Dev Testing!"
atomic_tests:
  - name: Josh Super Awesome Dev Test
    auto_generated_guid: 453acf13-1dbd-47d7-b28a-172ce9228069
    description: |
      this is an epic and awesome description for my dev testing yaml file
    supported_platforms:
      - windows
    input_arguments:
      file:
        description: Path of the file to be used (if required)
        type: string
        default: PathToAtomicsFolder\..\ExternalPayloads\x64\sharpersist.exe
    dependency_executor_name: powershell
    dependencies:
      - description: |
          File must exist on disk at specified location (#{file})
        prereq_command: |
          if (Test-Path "#{file}") {exit 0} else {exit 1}
        get_prereq_command: |
          echo "this is a command to get a prerequisite"
    executor:
      command: |
        "#{file}" "-t reg -c \"C:\\Windows\\System32\\cmd.exe\" -a \"/c calc.exe\" -k \"hkcurun\" -v \"Test Stuff\" -m add"
      cleanup_command: |
        "#{file}" "-t reg -k \"hkcurun\" -v \"Test Stuff\" -m remove"
      name: command_prompt
      elevation_required: true
